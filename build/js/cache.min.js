(function(c,r){function k(){c[h]||(c[h]={});return c[h]}var h="app",g;g=k();g.namespace=function(g,k){if(g){g=String(g);var l=g.split("."),n=l.length,e=c[h],a;e||(c[h]={});if(!l)return!1;for(a=0;a<n;a+=1)e[l[a]]||(e[l[a]]={}),a===n-1&&k&&(e[l[a]]=k),e=e[l[a]];return e}return!1};c[h]=g;c.getNamespace=c.getNs=k})(window);
(function(c,r){function k(){if(!(this instanceof k))return new k;this.methods=[];this.response=null;this.flushed=!1}k.prototype=k.fn={add:function(c){this.flushed?c(this.response):this.methods.push(c)},flush:function(c){if(!this.flushed)for(this.response=c,this.flushed=!0;this.methods[0];)this.methods.shift()(c)}};c.namespace("helpers.queue",k)})(window.getNs());
(function(c,r,k,h){var g=function(){var k=null,p=c.console!==h,l=p?c.console:null,n=p&&l.time!==h&&l.timeEnd!==h,e=[];return{isString:function(a){return"string"===typeof a||a instanceof String},isFunction:function(a){return"function"===typeof a||a instanceof Function},isArray:function(a){var b=Array.isArray,d=Object.prototype.toString;g.isArray=b&&"function"===typeof b?function(a){return b(a)}:d&&"function"===d?function(a){return"[object Array]"===d.call(a)}:function(a){return!!a.sort&&"function"===
typeof a.sort};return g.isArray(a)},inArray:function(a,b,d){g.inArray=Array.prototype.indexOf?function(a,b,d){return e.indexOf.call(b,a,d)}:function(a,b,d){var c=b.length,f=0;if(d)return b[d]&&b[d]===a?d:-1;for(f=0;f<c;f+=1)if(b[f]===a)return f;return-1};return g.inArray(a,b,d)},callback:function(a){g.isFunction(a)||(a=function(){return h});return a},on:function(a,b,d){g.on="function"===typeof c.addEventListener?function(a,b,d){a.addEventListener(b,d,!1)}:"function"===typeof r.attachEvent?function(a,
b,d){a.attachEvent("on"+b,d)}:function(a,b,d){a["on"+b]=d};g.on(a,b,d)},off:function(a,b,d){g.off="function"===typeof c.removeEventListener?function(a,b,d){a.removeEventListener(b,d,!1)}:"function"===typeof r.detachEvent?function(a,b,d){a.detachEvent("on"+b,d)}:function(a,b){a["on"+b]=null};g.off(a,b,d)},getXhr:function(){for(var a=null,b=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],
d=b.length,c=0,c=0;c<d;c+=1){try{a=b[c]()}catch(s){continue}break}return a},xhr:function(a,b,d,c){var s=g.getXhr(),m,e="GET";b=g.callback(b);if(s)if(a){c!==h?e="POST":c=null;d===h&&(d=!0);m=function(){if(4===s.readyState&&(200<=s.status&&400>s.status||0===s.status))try{var a=s.responseText;a?b(a):b(!1)}catch(d){b(!1)}else 4===s.readyState&&b(!1)};s.open(e,a,d);try{s.onreadystatechange!==h?s.onreadystatechange=m:s.onload!==h&&(s.onload=m)}catch(f){s.onload=null,s.onload=m}s.send(c)}else b(!1);else b(!1)},
getJson:function(){null===k&&(c.JSON&&c.JSON.stringify)&&(k=c.JSON);return k},jsonToString:function(a){var b=!1;null===k&&(k=g.getJson());k&&a!==h&&(b=k.stringify(a));return b},jsonToObject:function(a){var b=!1;null===k&&(k=g.getJson());k&&a!==h&&(b=k.parse(a));return b},logTimerStart:function(a){n&&c.console.time(a)},logTimerEnd:function(a){n&&c.console.timeEnd(a)},url:function(a){if(g.isString(a)){var b=r.createElement("a"),d;b.href=a;d=b.pathname.match(/\/([^\/?#]+)$/i);return{source:a,protocol:b.protocol,
host:b.hostname,port:b.port,query:b.search,file:d?d[1]:"/",hash:b.hash,path:b.pathname.replace(/^([^\/])/,"/$1"),extension:function(a){a=a.split(".");return a.length?a[a.length-1]:!1}(a),folder:function(){var b=a.lastIndexOf("/");return a.substr(0,b+1)}()}}},trim:function(a){if(!g.isString(a))return a;g.isFunction(String.prototype.trim)||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});return a.trim()}}}();k.namespace("helpers.utils",g)})(window,document,window.getNs());
(function(c,r,k,h){var g=function(){function g(){n===h&&(b(c,"online",g),b(c,"offline",g));n=r.onLine!==h?!!r.onLine:!0}var p,l,n,e,a=(r.userAgent||r.vendor||c.opera).toLowerCase(),b=k.helpers.utils.on;return{isMsie:function(){l===h&&(l=null!==a.match(/(msie)/));return l},isOpera:function(){p===h&&(p=null!==a.match(/(opera)/));return p},isOnline:function(){n===h&&g();return n},hasCanvas:function(){if(e===h){var a=document.createElement("canvas");e=!(!a.getContext||!a.getContext("2d"))}return e}}}();
k.namespace("helpers.client",g)})(window,window.navigator,window.getNs());
(function(c,r,k){function h(h,g){g&&(g.dom?h=g.dom:g.id&&(h=c.getElementById(g.id)));return h}var g=function(){var q=r.helpers,p=q.utils,l=q.client,n=[],e=[],a=[],b=[],d=c.getElementsByTagName("head")[0];return{nuke:function(){n=[];e=[];a=[];b=[]},createDomNode:function(a,b){var d=c.createElement(a),e;if(b)for(e in b)b.hasOwnProperty(e)&&d.setAttribute(e,b[e]);return d},hasClass:function(a,b){return RegExp(" "+b+" ").test(" "+a.className+" ")},getAttribute:function(a,b){return a.getAttribute(b)},
setAttribute:function(a,b,d){a.setAttribute(b,d)},appendCss:function(a,b,e,A,f){if(-1===p.inArray(a,n)||f){var k;f=h(null,A);if(null!==b){f||(f=g.createDomNode("style",{type:"text/css"}),f.className="lazyloaded");f.onerror=function(){e(!1)};A||d.appendChild(f);try{k=c.createTextNode(b),f.appendChild(k)}catch(v){f.styleSheet.cssText=b}finally{e()}}else null!==a&&(f||(f=g.createDomNode("link",{rel:"stylesheet",type:"text/css"}),f.className="lazyloaded"),f.onerror=function(){e(!1)},A||d.appendChild(f),
l.isMsie()||l.isOpera()?f.onload=e:e(),f.href=a);n.push(a)}else e()},appendJs:function(a,b,m,n,f){if(-1===p.inArray(a,e)||f){f=g.createDomNode("script");var k=c.getElementsByTagName("script")[0],l=!1;(f=h(f,n))?(f.type="text/javascript",f.className="lazyloaded",f.async=!0,f.onreadystatechange=f.onload=function(){l||this.readyState&&"complete"!==this.readyState&&"loaded"!==this.readyState||(this.onreadystatechange=this.onload=null,l=!0,e.push(a),m())},f.onerror=function(){this.onload=this.onreadystatechange=
this.onerror=null;m()},n||(k?k.parentNode.insertBefore(f,k):d.appendChild(f)),b&&!l?(f.textContent?f.textContent=b:f.nodeValue?f.nodeValue=b:f.text=b,l=!0):null!==a&&(f.src=a),l&&(e.push(a),m())):m()}else m()},appendImg:function(b,d,c,e){var f=null;(f=h(f,e))||(f=new Image);f.onerror=function(){f.onload=f.onerror=null;c()};f.onload=function(){f.onload=f.onerror=null;c()};d?f.src=d:b&&(f.src=b);if(f.complete&&f.naturalWidth!==k)f.onload();a.push(b)},appendHtml:function(a,d,e,n){var f=h(null,n);if(f){if(d)try{f.innerHTML=
d,n.id&&l.isMsie()&&c.styleSheets[0].addRule("#"+n.id+":after",'content: " ";')}catch(g){f.innerText=d}e();b.push(a)}else e()}}}();r.namespace("helpers.dom",g)})(document,window.getNs());
(function(c,r){function k(a,b,d){var e=function(a){d(!1)};if("."===b[0]||""===b[0])b=b.slice(1);b[0]?a.getDirectory(b[0],{create:!0},function(a){b.length?k(a,b.slice(1),d):d(!0)},e):d(!0)}function h(a,b,d){b=b.split("/");var e=b.length,c="",m=0;d=n(d);if(e){for(m=0;m<e-1;m+=1)c=c+b[m]+"/";k(a.root,c.split("/"),d)}else d(!0)}function g(a){if(!(this instanceof g))return new g(a);this.adapter=null;this.type=q;this.size=52428800;this.init(a)}var q="fileSystem",p=c.getNs&&c.getNs()||c,l=p.helpers.utils,
n=l.callback,e=null;g.prototype=g.fn={isSupported:function(){null===e&&(e=(!!c.requestFileSystem||!!c.webkitRequestFileSystem||!!c.moz_requestFileSystem)&&(!!c.Blob||!!c.BlobBuilder)&&c.FileReader);return e},open:function(a){var b=this,d=b.adapter,e=function(b){a(!1)};a=n(a);null===d?(c.requestFileSystem=c.requestFileSystem||c.webkitRequestFileSystem||c.moz_requestFileSystem,c.requestFileSystem(c.TEMPORARY,b.size,function(e){d=b.adapter=e;try{b.create("test-item",l.jsonToString({test:"test-content"}),
function(e){e?b.remove("test-item",function(){a(d)}):a(!1)})}catch(c){a(!1)}},e)):a(d)},create:function(a,b,d){d=n(d);a||d(!1);var e=this.adapter,c=function(a){d(!1,a)};h(e,a,function(){e.root.getFile(a,{create:!0},function(a){a.createWriter(function(a){var f;a.onwriteend=function(){d(!0)};a.onerror=c;try{Blob?(f=new Blob([b],{type:"text/plain"}),a.write(f)):BlobBuilder&&(f=new BlobBuilder,f.append(b),a.write(f.getBlob("application/json")))}catch(e){c(e)}},c)},c)})},read:function(a,b){b=n(b);a||b(!1);
var d=this.adapter,e=function(a){b(!1,a)};h(d,a,function(){d.root.getFile(a,{create:!1},function(a){a.file(function(a){var d=new FileReader;d.onloadend=function(){b(this.result)};d.onerror=e;d.onabort=e;d.readAsText(a)},e)},e)})},update:function(a,b,d){this.create(a,b,d)},remove:function(a,b){b=n(b);a||b(!1);var d=this.adapter,e=function(a){b(!1,a)};h(d,a,function(){d.root.getFile(a,{create:!1},function(a){a.remove(function(){b(!0)},e)},e)})},init:function(a){return this.isSupported()?(a&&a.size&&
(this.size=a.size),this):!1}};l.isFunction(p.namespace)?p.namespace("cache.storage.adapter."+q,g):p[q]=g})(window);
(function(c,r){function k(c){if(!(this instanceof k))return new k(c);this.adapter=null;this.type=h;this.dbName="cache";this.dbVersion="1.0";this.dbTable="offline";this.dbDescription="Local offline cache";this.dbKey="key";this.init(c)}var h="indexedDatabase",g=c.getNs&&c.getNs()||c,q=g.helpers.utils,p=q.callback,l=null;k.prototype=k.fn={isSupported:function(){null===l&&(l=!!c.indexedDB||!!c.webkitIndexedDB||!!c.mozIndexedDB||!!c.OIndexedDB||!!c.msIndexedDB);return l},create:function(c,e,a){a=p(a);
c||a(!1);var b=this.dbTable,d=this.adapter.transaction([b],"readwrite");c=d.objectStore(b).put({key:c,content:e});d.onerror=function(b){a(!1,b)};c.onerror=function(b){a(!1,b)};c.onsuccess=function(){a(!0)}},read:function(c,e){e=p(e);c||e(!1);var a=this.dbTable,b=this.adapter.transaction([a],"readonly"),a=b.objectStore(a).get(c);b&&a?(b.onerror=function(a){e(!1,a)},a.onerror=function(a){e(!1,a)},a.onsuccess=function(a){a.target.result&&a.target.result.content?e(a.target.result.content):e(!1)}):e(!1)},
update:function(c,e,a){this.create(c,e,a)},remove:function(c,e){e=p(e);c||e(!1);var a=this.dbTable,b=this.adapter.transaction([a],"readwrite"),a=b.objectStore(a).put({key:c,content:""});b.onerror=function(a){e(!1,a)};a.onerror=function(a){e(!1,a)};a.onsuccess=function(){e(!0)}},open:function(h,e){e||(e=!1);h=p(h);var a=this,b=null,d=null,g=null,s=a.dbName,m=a.dbTable,k=function(b){b||h(!1);a.create("test-item",'{test: "test-content"}',function(d){d?a.remove("test-item",function(){h(b)}):h(!1)})},
f,l,q,t,x;if(null===a.adapter)if(b=c.indexedDB||c.webkitIndexedDB||c.mozIndexedDB||c.OIndexedDB||c.msIndexedDB){c.webkitIndexedDB!==r&&(c.IDBTransaction=c.webkitIDBTransaction,c.IDBKeyRange=c.webkitIDBKeyRange);f=function(b){b.createIndex(a.dbKey,a.dbKey,{unique:!0});b.createIndex("content","content",{unique:!1})};l=function(b){var c=d.result,e,s;a.adapter=c;a.dbVersion===c.version||!c.setVersion&&"function"!==typeof c.setVersion?(a.adapter=c,k(c)):(g=b.currentTarget.result.setVersion(a.dbVersion),
g.onfailure=function(a){h(!1)},g.onsuccess=function(b){e=d.result;s=e.createObjectStore(m,{keyPath:a.dbKey});f(s)})};q=function(b){b=d.result.createObjectStore(m,{keyPath:a.dbKey});f(b)};t=function(b){e||a.open(h,!0);h(!1)};x=function(a){h(!1)};if(e)try{d=b.open(s,a.dbVersion)}catch(C){d=b.open(s)}else d=b.open(s);d.onsuccess=l;d.onupgradeneeded=q;d.onerror=t;d.onblocked=x}else h(!1);else k(a.adapter)},init:function(c){return this.isSupported()?(c&&(c.name&&(this.dbName=String(c.name)),c.version&&
(this.dbVersion=parseInt(c.version,10)),c.table&&(this.dbTable=c.table),c.description&&(this.dbDescription=String(c.description)),c.key&&(this.dbKey=c.key)),this):!1}};q.isFunction(g.namespace)?g.namespace("cache.storage.adapter."+h,k):g[h]=k})(window);
(function(c,r){function k(c,a,b,d,h,s){!s&&c?c.transaction(function(c){c.executeSql(a,b,d,h)}):s?s.executeSql(a,b,d,h):h(null,{code:0,message:"The storage adapter isn't available"})}function h(c){if(!(this instanceof h))return new h(c);this.adapter=null;this.type=g;this.dbName="cache";this.dbVersion="1.0";this.dbDescription="resource cache";this.dbTable="websql";this.dbSize=4194304;this.init(c)}var g="webSqlDatabase",q=c.getNs&&c.getNs()||c,p=q.helpers.utils,l=p.callback,n=null;h.prototype=h.fn={isSupported:function(){null===
n&&(n=!!c.openDatabase);return n},create:function(c,a,b){b=l(b);c||b(!1);k(this.adapter,"INSERT INTO "+this.dbTable+" (key, content) VALUES (?,?);",[c,a],function(){b(!0)},function(a,c){b(!1,c,{transaction:a})})},read:function(c,a){a=l(a);c||a(!1);k(this.adapter,"SELECT content FROM "+this.dbTable+" WHERE key=?;",[c],function(b,c){var e=!1;c&&(c.rows&&1===c.rows.length)&&(e=c.rows.item(0).content);a(e,null,{transaction:b})},function(b,c){a(!1,c,{transaction:b})})},update:function(c,a,b){b=l(b);c||
b(!1);k(this.adapter,"UPDATE "+this.dbTable+" SET content = ?  WHERE key=?;",[a,c],function(){b(!0)},function(a,c){b(!1,c,{transaction:a})})},remove:function(c,a){a=l(a);c||a(!1);k(this.adapter,"DELETE FROM "+this.dbTable+" WHERE key = ?;",[c],function(){a(!0)},function(b,c){a(!1,c,{transaction:b})})},open:function(e){e=l(e);var a=this,b=a.adapter,d=function(b){b||e(!1);a.create("test-item",'{test: "test-content"}',function(c){c?a.remove("test-item",function(){e(b)}):e(!1)})},h=function(b,c){k(b,
"CREATE TABLE IF NOT EXISTS "+a.dbTable+"(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, key TEXT NOT NULL UNIQUE, content TEXT NOT NULL);",[],function(){d(a.adapter)},function(a){d(!1)},c)},s=function(a){h(null,a)},m=function(a){e(!1)};try{if(null===b&&a.isSupported())if(a.adapter=b=c.openDatabase(a.dbName,"",a.dbDescription,a.dbSize),String(b.version)!==String(a.dbVersion)&&b.changeVersion&&"function"===typeof b.changeVersion)try{b.changeVersion(b.version,a.dbVersion,s,m)}catch(g){e(!1)}else b=
c.openDatabase(a.dbName,a.dbVersion,a.dbDescription,a.dbSize),h(b);else a.isSupported()&&d(b)}catch(f){e(!1)}},init:function(c){return this.isSupported()?(c&&(c.description&&(this.dbDescription=c.description),c.name&&(this.dbName=c.name),c.size&&(this.dbSize=c.size),c.table&&(this.dbTable=c.table),c.version&&(this.dbVersion=String(c.version))),this):!1}};p.isFunction(q.namespace)?q.namespace("cache.storage.adapter."+g,h):q[g]=h})(window);
(function(c,r){function k(a){a=l(a);switch(a){case "local":a="localStorage";break;case "session":a="sessionStorage";break;default:a="localStorage"}return a}function h(a){if(!(this instanceof h))return new h(a);this.adapter=null;this.type=g;this.lifetime="local";this.asynch=!0;this.init(a)}var g="webStorage",q=c.getNs&&c.getNs()||c,p=q.helpers.utils,l=p.trim,n=p.callback,e=null;h.prototype=h.fn={isSupported:function(){var a=k(this.lifetime);if(null===e)try{e=!!c[a]&&!!c[a].getItem}catch(b){e=!1}return e},
create:function(a,b,c){var e=this,h=!0,m=function(a){if(e.asynch)c(a);else return a};c=n(c);if(!a)return m(!1);try{e.adapter.setItem(a,b)}catch(g){h=!h}return m(h)},read:function(a,b){var c=this,e,h=!0,m=function(a){if(c.asynch)b(a);else return a};b=n(b);if(!a)return m(!1);try{h=(e=c.adapter.getItem(a))?e:!1}catch(g){h=!h}return m(h)},update:function(a,b,c){if(this.asynch)this.create(a,b,c);else return this.create(a,b,c)},remove:function(a,b){var c=this,e=!0,h=function(a){if(c.asynch)b(a);else return a};
b=n(b);if(!a)return h(!1);try{c.adapter.removeItem(a)}catch(g){e=!e}return h(e)},open:function(a){var b=this,d=b.adapter,e=k(b.lifetime),h,g,l=function(c){if(b.asynch)a(c);else return c};a=n(a);if(null===d)try{if(d=b.adapter=c[e],b.asynch)b.create("test-item",'{test: "test-content"}',function(c){c?b.remove("test-item",function(){a(d)}):a(!1)});else{if(h=b.create("test-item",'{test: "test-content"}'))if(g=b.remove("test-item"))return d;return!1}}catch(f){return l(!1)}else if(b.isSupported())return l(d)},
init:function(a){return this.isSupported()?(a&&(a.lifetime&&(this.lifetime=l(String(a.lifetime))),a.asynch!==r&&(this.asynch=!!a.asynch)),this):!1}};p.isFunction(q.namespace)?q.namespace("cache.storage.adapter."+g,h):q[g]=h})(window);
(function(c,r,k){function h(a,b){b.isLoaded||(b.isLoaded=!0,b.progressCallback(100),c.setTimeout(function(){a()},b.delay))}function g(a){if(!(this instanceof g))return new g(a);this.adapter=null;this.type=q;this.isLoaded=!1;this.delay=0;this.opened=!0;this.init(a)}var q="applicationCache",p=c.getNs&&c.getNs()||c,l=p.helpers,n=l.utils,e=l.dom,a=n.on,b=n.callback,d=null,y=r.getElementsByTagName("html")[0];g.prototype=g.fn={isSupported:function(){null===d&&(d=!!c.applicationCache&&!!e.getAttribute(y,
"manifest"));return d},open:function(d,e){var g=this,f=g.adapter,l=0,n,t;g.opened=!0;d=b(d);e&&e.progress&&(n=e.progress);n=g.progressCallback=b(n);if(g.isSupported()&&null!==f){t=function(){try{f.swapCache()}catch(a){}confirm("A new version of this website is available. Do you want to an update?")?c.location.reload(!0):h(d,g);return!1};a(f,"noupdate",function(){h(d,g);return!1});a(f,"downloading",function(){l=0;return!1});a(f,"progress",function(a){var b=0;g.delay=500;l+=1;b=a&&a.lengthComputable!==
k?Math.round(100*a.loaded/a.total):Math.round(100*l/20);n(b);return!1});a(f,"cached",function(){h(d,g);return!1});a(f,"updateready",function(){t()});a(f,"obsolete",function(){c.location.reload(!0);return!1});a(f,"error",function(){h(d,g);return!1});switch(f.status){case f.UNCACHED:h(d,g);break;case f.IDLE:h(d,g);break;case f.UPDATEREADY:t();break;case f.OBSOLETE:h(d,g)}a(c,"online",function(){try{f.update()}catch(a){}});c.setTimeout(function(){g.isLoaded||h(d,g)},12E3)}else h(d,g)},init:function(a){a=
this.adapter;this.isSupported()&&null===a&&(this.adapter=c.applicationCache);return this}};p.namespace("cache.storage.adapter."+q,g)})(window,document);
(function(c,r,k,h){function g(a,b,d){d.timeout=c.setTimeout(function(){b(!1)},4E3);v(a,function(a){c.clearTimeout(d.timeout);delete d.timeout;a?b(a):b(!1)})}function q(a){var b=null;try{b=m.jsonToObject(a)}catch(c){}return b}function p(a,b,c){if(C){var d=r.createElement("canvas"),e,f=new Image,g=null,k=0,m=0;c||(c="jpeg");f.onerror=function(){f.onload=f.onerror=null;b()};f.onload=function(){f.onload=f.onerror=null;k=d.height=f.height;m=d.width=f.width;e=d.getContext("2d");e.fillStyle="rgba(50, 50, 50, 0)";
e.fillRect(0,0,m,k);e.drawImage(f,0,0);g=d.toDataURL("image/"+c);b(g)};f.src=a;if(f.complete&&f.naturalWidth!==h)f.onload()}else b(!1)}function l(a){var b=a.data,c=a.url;"css"===a.type&&(c=m.url(c),c=c.folder,b=b.replace(/url\(\../g,"url("+c+".."),b=b.replace(/url\(\'../g,"url('"+c+".."),b=b.replace(/url\(\"../g,'url("'+c+".."),a.data=b);return a}function n(a,b){return{ajax:a.ajax,data:a.data,expires:(new Date).getTime()+(a.lifetime||b.lifetime),group:a.group!==h?a.group:b.group,lastmod:a.lastmod||
b.lastmod,lifetime:a.lifetime!==h?a.lifetime:b.lifetime,type:a.type||b.type,version:a.version||b.version}}function e(a){return z&&z[a]?!!z[a]:!1}function a(b,c){var d=null,f,e;b&&b.length?(f=b[0].type,e=b.slice(1),x[f]?d=new x[f](w):a(e,c),d&&d.isSupported()?d.open(function(h){h?(B=f,z=b[0],c(d)):a(e,c)}):a(e,c)):B||c(!1)}function b(c,d,f){var e=null,h=0,g;if(f)try{x[f]?(e=new x[f](w))&&e.isSupported()?e.open(function(a){if(a){B=f;g=d.length;for(h=0;h<g;h+=1)d[h].type===f&&(z=d[h]);z?c(e):b(c,d)}else b(c,
d)}):b(c,d):b(c,d)}catch(k){b(c,d)}else a(d,c)}function d(a,b){if(!(this instanceof d))return new d(a,b);this.isEnabled=!0;this.appCacheAdapter=this.adapter=null;this.adapters={types:D,defaults:w};this.resources={defaults:E};this.init(a,b)}var y=k.helpers,s=y.client,m=y.utils,A=m.isArray,f=m.callback,u=m.getJson(),v=m.xhr,t=m.trim,x=k.cache.storage.adapter,C=s.hasCanvas(),D=[{type:"fileSystem",css:!0,js:!0,html:!0,img:!0},{type:"indexedDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webSqlDatabase",
css:!0,js:!0,html:!0,img:!0},{type:"webStorage",css:!0,js:!0,html:!0,img:!0}],w={name:"localcache",table:"cache",description:"local resource cache",size:4194304,version:"1.0",key:"key",lifetime:"local",offline:!0},B=null,z=null,E={ajax:!0,lifetime:2E4,group:0,lastmod:(new Date).getTime(),type:"css",version:1};d.prototype=d.fn={create:function(a,b){b=f(b);if(a&&a.url){var c=this,d=a.url,h=a.type,k=function(f){if(f)if(a.data=f,a=l(a),null!==c.adapter&&e(h)){f=m.jsonToString(d);var g=n(a,c.resources.defaults),
k=m.jsonToString(g);a.expires=g.expires;a.version=g.version;try{c.adapter.create(f,k,function(c){c?b(a):b(!1)})}catch(t){b(a)}}else b(a);else b(a)};a.ajax?"img"===h?p(d,k):g(d,k,a):a.data?k(a.data):b(!1)}else b(!1)},read:function(a,b){b=f(b);if(a&&a.url){var c=this,d=a.url,h=a.type;if(null!==this.adapter&&e(h))try{c.adapter.read(m.jsonToString(d),function(f){f?(a=q(f))?(a.url=d,b(a,!0)):c.remove({url:d,type:h},function(){b(!1)}):b(!1)})}catch(k){g(d,function(c){a.data=c;b(a,!0)},a)}else b(a)}else b(!1)},
update:function(a,b){b=f(b);if(a&&a.url){var c=this,d=a.url,h=a.type,k=function(f){if(f)if(a.data=f,a=l(a),null!==c.adapter&&e(h)){f=m.jsonToString(d);var g=n(a,c.resources.defaults),k=m.jsonToString(g);a.expires=g.expires;a.version=g.version;try{c.adapter.update(f,k,function(c){c?b(a):b(!1)})}catch(t){b(a)}}else b(a);else c.read(a,function(c){c&&c.data?(a.data=c.data,b(a)):b(!1)})};a.ajax?"img"===h?p(d,k):g(d,k,a):a.data?k(a.data):b(!1)}else b(!1)},remove:function(a,b){b=f(b);if(a&&a.url){var c=
a.url,d=a.type;null!==this.adapter&&e(d)?this.adapter.remove(m.jsonToString(c),function(c){c?b(a):b(!1)}):b(a)}else b(!1)},init:function(a,c){var d=this,e=!1,g,k,m,l;a=f(a);c&&c.isEnabled!==h&&(d.isEnabled=!!c.isEnabled);if(d.isEnabled&&u){if(c){if(c.adapters){g=c.adapters;if(g.types&&A(g.types)){k=g.types;m=k.length;for(l=0;l<m;l+=1)k[l].css===h&&(k[l].css=!0),k[l].js===h&&(k[l].js=!0),k[l].img===h&&(k[l].img=!0),k[l].html===h&&(k[l].html=!0);d.adapters.types=k}g.defaults&&(k=g.defaults,m=d.adapters.defaults,
k.name&&(m.name=t(String(k.name))),k.table&&(m.table=t(String(k.table))),k.description&&(m.description=t(String(k.description))),k.size&&(m.size=parseInt(k.size,10)),k.version&&(m.version=t(String(k.version))),k.key&&(m.key=t(String(k.key))),k.lifetime&&(m.lifetime=t(String(k.lifetime))),k.offline!==h&&(m.offline=!!k.offline));g.preferredType&&(e=t(String(g.preferredType)))}c.resources&&(g=c.resources,g.defaults&&(g=g.defaults,k=d.resources.defaults,g.ajax!==h&&(k.ajax=!!g.ajax),g.lifetime!==h&&(k.lifetime=
parseInt(g.lifetime,10)),g.group!==h&&(k.group=parseInt(g.group,10)),g.lastmod!==h&&(k.lastmod=parseInt(g.lastmod,10)),g.type&&(k.type=t(String(g.type))),g.group!==h&&(k.version=parseFloat(g.version)),g.loaded&&(k.loaded=f(g.loaded))))}b(function(b){d.adapter=b;a(d)},d.adapters.types,e);d.adapters.defaults.offline&&(x.applicationCache&&!d.appCacheAdapter)&&(d.appCacheAdapter=new x.applicationCache(w))}else a(d)}};k.namespace("cache.storage.controller",d)})(window,document,window.getNs());
(function(c,r){function k(a){var c=e(a.type);if("js"!==c||"css"!==c||"html"!==c||"img"!==c||"custom"!==c){switch(p.url(a.url).extension){case "js":a="js";break;case "css":a="css";break;case "html":a="html";break;case "jpg":case "jpeg":case "png":a="img";break;default:a="custom"}c=a}return c}function h(a,c){if(!(this instanceof h))return new h(a,c);this.storage=null;this.init(a,c)}var g=c.helpers,q=g.dom,p=g.utils,l=g.client,n=p.isArray,e=p.trim,a=p.callback;h.prototype=h.fn={load:function(b,c){var g=
this,h=(new Date).getTime(),m=function(){var a=0,b=0,c=null;return{init:function(d,f){c=f;a=d;b=0},loaded:function(){b+=1;b===a&&c()}}}(),p=function(a,b,c){var d=a.url,f=function(){a.loaded(a);m.loaded()},e=a.node||null;c=!!c;switch(a.type){case "js":q.appendJs(d,b,f,e,c);break;case "css":q.appendCss(d,b,f,e,c);break;case "img":q.appendImg(d,b,f,e,c);break;case "html":q.appendHtml(d,b,f,e,c);break;default:f()}},f=function(b){var c=b.data||null,d=function(a,b){a&&a.data?p(a,a.data,b):p(a,null,b)},
f=g.storage,e=f.resources.defaults;b.ajax=b.ajax!==r?!!b.ajax:e.ajax;b.loaded=b.loaded!==r?a(b.loaded):a(e.loaded);f.read(b,function(a){if(a&&a.data){var e=b,k=g.storage.resources.defaults,m=parseInt(a.lifetime,10),n=a.version,q=a.lastmod?a.lastmod:0,w=!1,v,u=e.lastmod?e.lastmod:0,w=!0;v=!1;e.version=v=e.version!==r?parseFloat(e.version):k.version;e.group=e.group!==r?parseFloat(e.group):k.group;u&&q?(e.lastmod=parseInt(u,10),w=q===e.lastmod):!u&&q?u=q:u||(u=k.lastmod);w=w&&v===n;v=0!==m&&(-1!==m&&
w&&a.expires>h||-1===m&&w);e.lastmod=u;e.isValid=v;b=e;b.isValid||!l.isOnline()?(c=a.data)&&p(b,c):f.update(b,d)}else f.create(b,d)})},u=function(a,b){var c=0,d=a.length,g=null;m.init(d,b);for(c=0;c<d;c+=1)(g=a[c])&&g.url&&(g.url=e(g.url),g.type=k(g),f(g))},v=function(a,b,c){var d=a.length;for(c||(c=0);!a[c]&&c<d;)c+=1;c>=d?b(g):(d=a[c],u(d,function(){v(a,b,c+1)}))};(function(b,f){b&&n(b)||(b=[]);for(var e=b,g=[],h,k=0,m,l=e.length,k=0;k<l;k+=1)m=e[k],(h=m.group)||(h=0),h=g[h]?g[h]:g[h]=[],h.push(m);
b=g;f=a(c);v(b,f)})(b,c)},remove:function(b,c){var g=this.storage,h=function(a,b){var c=a.length,d,h,l=function(a,d){a===c-1&&b()};if(c)for(d=0;d<c;d+=1)(h=a[d])&&h.url&&(h.url=e(h.url),h.type=k(h),g.remove(h,l(d,h.url)));else b()};(function(b,e){b&&n(b)||(b=[]);e=a(c);h(b,e)})(b,c)},init:function(b,d){var e=this;b=a(b);c.cache.storage.controller(function(a){e.storage=a;b(a)},d);return e}};c.namespace("cache.controller",h)})(window.getNs());
(function(c,r,k){function h(a){this.storage=this.controller=null;this.params=a;this.queue=new l;this.timeout=this.interval=this.calls=0}function g(a){var b=null,c=p.length,d;a||(a=y);for(d=0;d<c;d+=1)e(p[d].params)===e(a)&&(b=p[d]);b||(b=new h(a),p.push(b));return b}function q(a,e,h){var f=g(a),k,l,n=function(){k=f.interval;c.clearInterval(k);k=c.setInterval(function(){f.timeout=l=f.timeout+b;f.controller&&f.storage&&(c.clearInterval(k),f.queue.flush());l>d&&(c.clearInterval(k),h())},b)};f||h();f.storage?
e(f):(f.queue.add(function(){e(f)}),f.calls+=1,1===f.calls?f.controller=new r.cache.controller(function(a){f.storage=a;f.controller?f.queue.flush():n()},a):n())}var p=[];k=r.helpers;var l=k.queue;k=k.utils;var n=k.isArray,e=k.jsonToString,a=k.callback,b=25,d=5E3,y={};k=function(){return{load:function(b,c,d){c=a(c);q(d,function(a){n(b)?a.controller.load(b,c):"applicationCache"===b?(a=a.storage)&&a.appCacheAdapter&&!a.appCacheAdapter.opened?a.appCacheAdapter.open(c,d):c(!1):c(!1)},function(){c(!1)});
return this},remove:function(b,c,d){c=a(c);q(d,function(a){n(b)?a.controller.remove(b,c):c(!1)},function(){c(!1)});return this},setup:function(a){a&&(y=a);return this}}}();r.namespace("cache.load",k.load);r.namespace("cache.remove",k.remove);r.namespace("cache.setup",k.setup)})(window,window.getNs());
