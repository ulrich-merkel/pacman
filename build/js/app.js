!function(a,b,c,d){"use strict";var e=function(){function e(){var b=parseInt(a.orientation,10);switch(b){case 0:P=U;break;case 180:P=U;break;case 90:P=T;break;case-90:P=T}}function f(){x=null!==W.match(/(iphone|ipod|ipad)/),x&&!S&&(X(a,"orientationchange",e),S=!0)}function g(){y=null!==W.match(/(webkit)/)}function h(){z=null!==W.match(/(android)/),z&&!S&&(X(a,"orientationchange",e),S=!0)}function i(){A=null!==W.match(/(blackberry)/),A&&!S&&(X(a,"orientationchange",e),S=!0)}function j(){B=null!==W.match(/(opera)/)}function k(){C=null!==W.match(/(chrome)/)}function l(){D=null!==W.match(/(safari)/)}function m(){E=null!==W.match(/(firefox)/)}function n(){F=null!==W.match(/(seamonkey)/)}function o(){G=null!==W.match(/(camino)/)}function p(){H=null!==W.match(/(msie)/)}function q(){I=null!==W.match(/(ipad)/),I&&!S&&(X(a,"orientationchange",e),S=!0)}function r(){J=null!==W.match(/(iphone)/),J&&!S&&(X(a,"orientationchange",e),S=!0)}function s(){K=!1,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(W)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(W.substr(0,4)))&&(K=!0,S||(X(a,"orientationchange",e),S=!0))}function t(){var a,c;c=W.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i),c&&null!==(a=V.match(/version\/([\.\d]+)/i))&&(c[2]=a[1]),L=c?c[2]:b.appVersion}function u(){if(f(),x){var a=b.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);M=[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3]||0,10)]}}function v(){N===d&&(X(a,"online",v),X(a,"offline",v)),N=b.onLine!==d?!!b.onLine:!0}function w(){var a=b.connection||b.mozConnection||b.webkitConnection||{type:0,UNKNOWN:0,ETHERNET:1,WIFI:2,CELL_2G:3,CELL_3G:4},c=function(){O=a};a.onchange=c,c()}var x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T="landscapeMode",U="portraitMode",V=b.userAgent||b.vendor||a.opera,W=V.toLowerCase(),X=c.helpers.utils.on;return{isiOS:function(){return x===d&&f(),x},isWebkit:function(){return y===d&&g(),y},isAndroid:function(){return z===d&&h(),z},isBlackberry:function(){return A===d&&i(),A},isChrome:function(){return C===d&&k(),C},isOpera:function(){return B===d&&j(),B},isSafari:function(){return D===d&&l(),D},isFirefox:function(){return E===d&&m(),E},isSeamonkey:function(){return F===d&&n(),F},isCamino:function(){return G===d&&o(),G},isMsie:function(){return H===d&&p(),H},isiPad:function(){return I===d&&q(),I},isiPhone:function(){return J===d&&r(),J},isMobile:function(){return K===d&&s(),K},getBrowserVersion:function(){return L===d&&t(),L},getiOSVersion:function(){return M===d&&u(),M},isOnline:function(){return N===d&&v(),N},getNetworkConnection:function(){return O===d&&w(),O},isStandalone:function(){return b.standalone!==d&&b.standalone},isTouchDevice:function(){return!!("ontouchstart"in a)||a.navigator.msMaxTouchPoints},orientation:function(){return a.orientation?a.orientation:0},orientationMode:function(){return P===d&&e(),P},hasRetinaDisplay:function(){return a.devicePixelRatio>=2},hasCanvas:function(){if(Q===d){var a=document.createElement("canvas");Q=!(!a.getContext||!a.getContext("2d"))}return Q},hideStatusbar:function(b){b||(b=0),a.clearTimeout(R),R=a.setTimeout(function(){0===parseInt(a.pageYOffset,10)&&a.scrollTo(0,1)},b)}}}();c.namespace("helpers.client",e)}(window,window.navigator,window.getNamespace()),function(a,b,c,d){"use strict";var e=function(){var c=null,f=a.console!==d&&a.console.log,g=a.console!==d&&console.time!==d&&console.timeEnd!==d,h=[];return{logToScreen:function(a){var c=b.getElementById("log"),d=b.createElement("p"),e=b.createTextNode(a);c&&(d.appendChild(e),c.appendChild(d))},log:function(b){f&&a.console.log(b),e.logToScreen(b)},logTimerStart:function(b){g&&a.console.time(b)},logTimerEnd:function(b){g&&a.console.timeEnd(b)},callback:function(a){return a&&"function"==typeof a||(a=function(){}),a},on:function(c,d,f){e.on="function"==typeof a.addEventListener?function(a,b,c){a.addEventListener(b,c,!1)}:"function"==typeof b.attachEvent?function(a,b,c){a.attachEvent("on"+b,c)}:function(a,b,c){a["on"+b]=c},e.on(c,d,f)},off:function(c,d,f){e.off="function"==typeof a.removeEventListener?function(a,b,c){a.removeEventListener(b,c,!1)}:"function"==typeof b.detachEvent?function(a,b,c){a.detachEvent("on"+b,c)}:function(a,b){a["on"+b]=null},e.off(c,d,f)},getXhr:function(){var a=null,b=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],c=b.length,d=0;for(d=0;c>d;d+=1){try{a=b[d]()}catch(e){continue}break}return a},xhr:function(a,b,c,f){var g,h=e.getXhr(),i="GET";if(b=e.callback(b),h){if(!a)return b(!1),void 0;f!==d?i="POST":f=null,c===d&&(c=!0),g=function(){if(4===h.readyState&&(h.status>=200&&h.status<400||0===h.status))try{var a=h.responseText;a?b(a):b(!1)}catch(c){b(!1)}},h.open(i,a,c);try{h.onreadystatechange!==d?h.onreadystatechange=g:h.onload!==d&&(h.onload=g)}catch(j){h.onload=null,h.onload=g}h.send(f)}else b(!1)},getJson:function(){return null===c&&a.JSON&&a.JSON.stringify&&(c=a.JSON),c},jsonToString:function(a){var b=!1;return null===c&&(c=e.getJson()),c&&a&&(b=c.stringify(a)),b},jsonToObject:function(a){var b=!1;return null===c&&(c=e.getJson()),c&&a&&(b=c.parse(a)),b},url:function(a){if(a){var c,d=b.createElement("a"),e=function(){var b=a.lastIndexOf("/"),c=a.substr(0,b+1);return c};return d.href=a,c=d.pathname.match(/\/([^\/?#]+)$/i),{source:a,protocol:d.protocol,host:d.hostname,port:d.port,query:d.search,file:c?c[1]:"/",hash:d.hash,path:d.pathname.replace(/^([^\/])/,"/$1"),folder:e()}}},queryString:function(){var b,c,e={},f=a.location.search.substring(1),g=f.split("&"),h=g.length,i=0;for(i=0;h>i;i+=1)b=g[i].split("="),e[b[0]]===d?e[b[0]]=b[1]:"string"==typeof e[b[0]]?(c=[e[b[0]],b[1]],e[b[0]]=c):e[b[0]].push(b[1]);return e}(),sprintf:function(a){var b=1,c=arguments;return a.replace(/%s/g,function(){return b<c.length?c[b++]:""})},trim:function(a){return"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),a.trim()},isArray:function(a){return e.isArray=Array.isArray&&"function"==typeof Array.isArray?function(a){return Array.isArray(a)}:Object.prototype.toString&&"function"===Object.prototype.toString?function(a){return"[object Array]"===Object.prototype.toString.call(a)}:function(a){return!!a.sort&&"function"==typeof a.sort},e.isArray(a)},inArray:function(a,b,c){return e.inArray=Array.prototype.indexOf?function(a,b,c){return h.indexOf.call(b,a,c)}:function(a,b,c){var d=b.length,e=0;if(c)return b[c]&&b[c]===a?c:-1;for(e=0;d>e;e+=1)if(b[e]===a)return e;return-1},e.inArray(a,b,c)}}}();c.namespace("helpers.utils",e)}(window,document,window.getNamespace()),function(a){var b=a({});a.subscribe=function(){b.on.apply(b,arguments)},a.unsubscribe=function(){b.off.apply(b,arguments)},a.publish=function(){b.trigger.apply(b,arguments)}}(jQuery),function(a){a("a[data-reveal-id]").on("click",function(b){b.preventDefault();var c=a(this).attr("data-reveal-id");a("#"+c).reveal(a(this).data())}),a.fn.reveal=function(b){var c={animation:"fadeAndPop",animationspeed:300,closeonbackgroundclick:!0,dismissmodalclass:"close-reveal-modal"},b=a.extend({},c,b);return this.each(function(){function c(){h=!1}function d(){h=!0}var e=a(this),f=parseInt(e.css("top")),g=e.height()+f,h=!1,i=a(".reveal-modal-bg");0==i.length&&(i=a('<div class="reveal-modal-bg" />').insertAfter(e)),e.bind("reveal:open",function(){i.unbind("click.modalEvent"),a("."+b.dismissmodalclass).unbind("click.modalEvent"),h||(d(),"fadeAndPop"==b.animation&&(e.css({top:a(document).scrollTop()-g,opacity:0,visibility:"visible"}),i.fadeIn(b.animationspeed/2),e.delay(b.animationspeed/2).animate({top:a(document).scrollTop()+f+"px",opacity:1},b.animationspeed,c())),"fade"==b.animation&&(e.css({opacity:0,visibility:"visible",top:a(document).scrollTop()+f}),i.fadeIn(b.animationspeed/2),e.delay(b.animationspeed/2).animate({opacity:1},b.animationspeed,c())),"none"==b.animation&&(e.css({visibility:"visible",top:a(document).scrollTop()+f}),i.css({display:"block"}),c()),e.addClass("opened")),e.unbind("reveal:open")}),e.bind("reveal:close",function(){h||(d(),"fadeAndPop"==b.animation&&(i.delay(b.animationspeed).fadeOut(b.animationspeed),e.animate({top:a(document).scrollTop()-g+"px",opacity:0},b.animationspeed/2,function(){e.css({top:f,opacity:1,visibility:"hidden"}),c()})),"fade"==b.animation&&(i.delay(b.animationspeed).fadeOut(b.animationspeed),e.animate({opacity:0},b.animationspeed,function(){e.css({opacity:1,visibility:"hidden",top:f}),c()})),"none"==b.animation&&(e.css({visibility:"hidden",top:f}),i.css({display:"none"})),e.removeClass("opened"),e.trigger("reveal:closed")),e.unbind("reveal:close")}),e.trigger("reveal:open");a("."+b.dismissmodalclass).bind("click.modalEvent",function(a){a.preventDefault(),e.trigger("reveal:close")});b.closeonbackgroundclick&&(i.css({cursor:"pointer"}),i.bind("click.modalEvent",function(){e.trigger("reveal:close")})),a("body").keyup(function(a){27===a.which&&e.trigger("reveal:close")})})}}(jQuery),function(a,b,c,d){"use strict";function e(){return k===d&&(k=!(!m||!m.requestFullscreen&&!m.mozRequestFullScreen&&!m.webkitRequestFullScreen)),k}function f(){return!!a.fullScreen||!!a.mozFullScreen||!!a.webkitIsFullScreen}function g(){m.requestFullscreen?m.requestFullscreen():m.mozRequestFullScreen?m.mozRequestFullScreen():m.webkitRequestFullScreen&&m.webkitRequestFullScreen()}function h(){a.exitFullscreen?a.exitFullscreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.webkitCancelFullScreen&&a.webkitCancelFullScreen()}function i(){}function j(){var a=b(".button-game-fullscreen"),c=a.find(".button-label"),d=a.find(".icomoon");e()&&(f()?(h(),c.text("Fullscreen On"),d.removeClass("icon-contract").addClass("icon-expand")):(g(),c.text("Fullscreen Off"),d.addClass("icon-contract").removeClass("icon-expand")))}var k,l,m=a.documentElement;c.namespace("plugins.fullscreen",j),b.fn.fullscreen=function(c,d){function f(c){var d=b(a);d.bind("fullscreenchange",i),d.bind("mozfullscreenchange",i),d.bind("webkitfullscreenchange",i),c.bind({"click.fullscreen":function(a){a.preventDefault(),j()}})}function g(a,c){if(c.length){if(e()){c.show();var d=c.data("fullscreen");d||(f(c),c.data("fullscreen","initialized"))}else c.hide();b.isFunction(a.cb)&&a.cb.call()}}return b.fn.fullscreen.defaults={sel:{elem:".btn-fullscreen"}},l=b.extend(!0,{},b.fn.fullscreen.defaults,c,{cb:d}),this.each(function(){g(l,b(this))})}}(document,window.jQuery,window.getNamespace()),function(a){"use strict";function b(b,c){this.$elem=a(b),this.options=a.extend(!0,{},d,c),this.init()}var c="styledCheckbox",d={selectors:{wrapperId:"#styledCheckbox",wrapperClass:".styledCheckbox-wrapper",replacementClass:".styledCheckbox",checkedClass:".checked"}};b.prototype={renderReplace:function(){var b,c,d,e,f,g=this,h=g.options,i=h.selectors,j=g.$elem;f=j.next("label"),g.$label=f,d=j.parent(),e=d.offset(),b=a("<div>",{id:i.wrapperId.substr(1)+"-"+e.top+"-"+e.left,"class":i.wrapperClass.substr(1)}),c=a("<div>",{"class":i.replacementClass.substr(1)}),"checked"===j.attr("checked")&&c.addClass(i.checkedClass.substr(1)),b.append(j).append(c).prependTo(d),g.$replacement=c},events:function(){var b=this;b.$replacement.on({"click.styledCheckbox touchstart.styledCheckbox":a.proxy(function(){b.toggleChecked()},b)}),b.$label.on({"click.styledCheckbox touchstart.styledCheckbox":a.proxy(function(a){a.preventDefault(),b.toggleChecked()},b)})},toggleChecked:function(){var a=this,b=a.options.selectors.checkedClass.substr(1),c=a.$elem,d=a.$replacement;d.hasClass("checked")?(c.removeAttr("checked"),d.removeClass(b)):(c.attr("checked","checked"),d.addClass(b))},init:function(){this.renderReplace(),this.events()}},a.fn[c]=function(d){return this.each(function(){a.data(this,"plugin_"+c)||a.data(this,"plugin_"+c,new b(this,d))})}}(window.jQuery),function(a,b,c,d){"use strict";c.fn.tooltip=function(a,b){c.fn.tooltip.defaults={sel:{elem:".tooltip",tooltipId:"#tooltip",attrSelector:"title"},fadeTime:300,delay:500,boxOffsetX:-60,boxOffsetY:-20,replaceString:""};c.extend(!0,c.fn.tooltip.defaults,a,{callback:b}),d.helpers.client;return this.each(function(){})},c.fn.tooltip.destroy=function(a){c(a).length&&(c("#tooltip").remove(),c(a).each(function(){c(this).unbind("mouseenter.tooltip mouseleave.tooltip mousemove.tooltip")}))}}(window,document,window.jQuery,window.getNamespace()),function(a,b,c){"use strict";var d=function(){function e(){var a,b,c=d.state;c.paused||c.destroyed||(d.frame++,d.frame%=30,d.stats.updateTime(),a=d.keyhandler.getMovement(),null!==a&&(I.newMovement=a),j(),k(),I.checkCollisions(),I.eat()&&(b=d.ghosts[0],d.pelletCount===L?b.elroyLevel=1:d.pelletCount===M?b.elroyLevel=2:0===d.pelletCount&&z()))}function f(){L=d.tools.elroyLevel(),M=L/2}function g(){d.fieldBuilder.buildScreenStart(),H="start"}function h(){d.fieldBuilder.buildScreenGame(),d.ghosts=[],d.ghosts.push(new d.Enemy("blinky",d.enemyStarts[0])),d.ghosts.push(new d.Enemy("inky",d.enemyStarts[1])),d.ghosts.push(new d.Enemy("pinky",d.enemyStarts[2])),d.ghosts.push(new d.Enemy("clyde",d.enemyStarts[3])),d.player=I=new d.Player,d.updateElroy(),k(),H="play"}function i(){d.video.show("end"),B();var a=function(){b.unsubscribe("pacman.videohide",a),d.fieldBuilder.buildScreenEnd(),d.stats.sendPoints(),H="end",D(!0),b.publish("pacman.end")};b.subscribe("pacman.videohide",a)}function j(){I.move(),b.each(d.ghosts,function(a,b){b.move()})}function k(){I.animate(),b.each(d.ghosts,function(a,b){b.animate()})}function l(a){I.setMode(a),b.each(d.ghosts,function(b,c){c.setMode(a)})}function m(){I.reset(),b.each(d.ghosts,function(a,b){b.reset()})}function n(a){d.mode=a,l(a)}function o(){n("chase"),d.timers.modeTimeout=setTimeout(s,15e3)}function p(){d.stats.frightStart(),d.blinkTimer=3,n("fright"),clearTimeout(d.timers.modeTimeout),clearTimeout(d.phaseEndInterval),d.timers.modeTimeout=setTimeout(q,7e3)}function q(){d.timers.phaseEndTimer=3,d.phaseEndInterval=setInterval(r,1e3)}function r(){0===d.timers.phaseEndTimer?(clearInterval(d.phaseEndInterval),o()):(d.svg.blinkGhosts(),d.timers.phaseEndTimer--)}function s(){n("scatter"),d.timers.modeTimeout=setTimeout(o,5e3)}function t(){d.state.destroyed||(d.countdownTimer<=0||void 0===d.countdownTimer?(clearInterval(d.timers.countDownInterval),d.timers.gameInterval=setInterval(e,1e3/60),o(),d.stats.setTimeStart()):(d.svg.animateCountdownNumber(d.playerStart,d.countdownTimer),d.countdownTimer--),C())}function u(a){d.countdownTimer=a,d.timers.countDownInterval=setInterval(t,1e3),d.audio.play("start")}function v(){B()}function w(){i(),d.stats.setTimeEnd()}function x(a){v(),b.each(d.ghosts,function(a,b){b.body.hide(),b.leftEye.hide(),b.rightEye.hide(),b.leftPupil.hide(),b.rightPupil.hide()}),d.svg.animatePlayerDeath(a)}function y(){v(),m(),d.video.show("death");var a=function(){b.unsubscribe("pacman.videohide",a),b.each(d.ghosts,function(a,b){b.body.show(),b.leftEye.show(),b.rightEye.show(),b.leftPupil.show(),b.rightPupil.show()}),k(),u(3)};b.subscribe("pacman.videohide",a)}function z(){v(),m(),d.stats.addLevel(),d.video.show("nextlevel");var a=function(){b.unsubscribe("pacman.videohide",a),d.updateElroy(),h(),u(2)};b.subscribe("pacman.videohide",a)}function A(){B(),d.stats.resetStats(),h(),u(3)}function B(){d.timers&&(clearInterval(d.timers.gameInterval),clearInterval(d.timers.phaseEndTimer),clearInterval(d.timers.countDownInterval),clearTimeout(d.timers.modeTimeout)),d.timers={}}function C(){var a=b(".button-game-pacman"),c=a.find(".button-label"),e=a.find(".icomoon");d.state.paused?(a.addClass("paused").removeClass("disabled playing"),c.text("Play Game"),e.addClass("icon-play").removeClass("icon-pause")):(a.removeClass("paused disabled").addClass("playing"),c.text("Pause Game"),e.removeClass("icon-play").addClass("icon-pause"))}function D(a){d.state.paused=void 0!==a?a:!d.state.paused,C()}function E(a){G=d.config;var e=G.playField[d.stats.getLevelString()],f=G.tileSize,g=e.width*f,h=e.height*f,i=c.pacman.keyhandler;a&&a.muted&&(G.muted=a.muted),c.pacman.paper=Raphael(G.containerId,0,0),b("#"+G.containerId).css({width:g+"px",height:h+"px"}),J.on({keydown:i.keydown,keyup:i.keyup}),B(),d.state={},d.timers={},d.video=new d.Video(d.paper,{width:g,height:h,muted:G.muted}),d.audio=new d.Audio(null,{muted:G.muted}),d.startGame()}function F(){var a=d.keyhandler;J.off({keydown:a.keydown,keyup:a.keyup}),B()}var G,H,I,J=b(a),K=0,L=0,M=0;return{setupScreenStart:g,setupScreenGame:h,startGame:A,startWithCountDown:u,start:t,pause:D,death:x,continueAfterDeath:y,end:w,frame:K,startFright:p,resetObjects:m,updateElroy:f,initialize:E,destroy:F}}();c.namespace("pacman",d)}(window.document,window.jQuery,window.getNamespace()),function(a){var b=a.pacman||{};b.tools=function(){function a(a){switch(a){case 0:return{x:1,y:0};case 1:return{x:0,y:1};case 2:return{x:-1,y:0};case 3:return{x:0,y:-1}}}function c(a,b,c,d){return Math.sqrt(Math.pow(a-c,2)+Math.pow(b-d,2))}function d(a){return{row:Math.floor(a.y/b.config.tileSize),col:Math.floor(a.x/b.config.tileSize)}}function e(a,b){return a.distance-b.distance}function f(){return b.config.tileSize/10}function g(a){var c=f(),d=b.stats.level;switch(a){case"fright":return 15>d?(85+d)/100*c:c;default:return 20>=d?(80+d)/100*c:.9*c}}function h(a,c){var d=f(),e=b.stats.level;switch(a){case"dead":return 1.5*d;case"fright":return.6*d;default:return 20>e?(75+e+5*c)/100*d:(.95+5*c)*d}}function i(){var a=b.stats.level;return 2>=a?30:5>=a?40:8>=a?50:11>=a?60:14>=a?80:17>=a?100:120}return{getMovement:a,distanceBetween:c,getTilePosition:d,sortByDistance:e,playerSpeed:g,enemySpeed:h,elroyLevel:i}}()}(window.app||{}),function(a,b){"use strict";var c,d=b.pacman||{};c=function(){var b=this;this.position=d.playerStart,this.originalStart=d.playerStart,this.movement={x:-1,y:0,objectRotation:180},this.newMovement=this.movement,this.mode="chase",this.paperObject=d.paper.path(),this.animate=function(){b.paperObject.attr(d.svg.pacmanBody(b.position,b.movement.objectRotation))},this.isChangingDirection=function(){return this.movement.x!==this.newMovement.x||this.movement.y!==this.newMovement.y?!0:!1},this.canChangeDirection=function(){var a,b,c,e=this,f=e.movement,g=e.newMovement,h=this.position,i=d.config.tileSize;return f.x===-1*g.x&&f.y===-1*g.y?!0:(a=d.tools.getTilePosition(e.position),b={x:i*a.col+i/2,y:i*a.row+i/2},c=d.tools.distanceBetween(h.x,h.y,b.x,b.y),i/8>c?!0:!1)},this.align=function(){var a,b,c=this,e=d.config.tileSize;a=d.tools.getTilePosition(c.position),b={x:e*a.col+e/2,y:e*a.row+e/2},c.position=b},this.canMove=function(a,b){var c,e,f=this,g=f.position,h=d.config.tileSize;return c={x:g.x+(h/2+b)*a.x,y:g.y+(h/2+b)*a.y},e=d.tools.getTilePosition(c),void 0===d.playerMovement[e.row]||void 0===d.playerMovement[e.row][e.col]||d.playerMovement[e.row][e.col]?!0:!1},this.doMovement=function(a,b){var c={x:this.position.x+b*a.x,y:this.position.y+b*a.y};this.position=c},this.correctPosition=function(){var a=this,b=a.position,c=d.config.tileSize,e=d.fieldInUse.width,f=d.fieldInUse.height;b.x<0&&(b.x+=c*e),b.x>c*e&&(b.x-=c*e),b.y<0&&(b.y+=c*f),b.y>c*f&&(b.y-=c*f)},this.move=function(){var a=this,b=d.tools.playerSpeed(a.mode);a.isChangingDirection()&&a.canChangeDirection()&&a.canMove(a.newMovement,b)?(a.movement.x===-1*a.newMovement.x&&a.movement.y===-1*a.newMovement.y?a.doMovement(a.newMovement,b):(a.align(),a.doMovement(a.newMovement,b)),a.movement=a.newMovement):(a.canMove(a.movement,b)?a.doMovement(a.movement,b):a.align(),a.newMovement=a.movement),a.correctPosition()},this.eat=function(){var a=this,b=d.tools.getTilePosition(a.position),c=d.pellets[b.row][b.col];return void 0===c||c.eaten?!1:(d.pelletCount=d.pelletCount-1,d.audio.play("pellet"),c.isPowerPellet?(d.startFright(),d.audio.play("power-pellet"),d.stats.addPoints(50)):d.stats.addPoints(10),c.hide(),c.eaten=!0,!0)},this.checkCollisions=function(){var b,c=d.tools.getTilePosition,e=c(d.player.position);a.each(d.ghosts,function(a,f){b=c(f.position),e.row===b.row&&e.col===b.col&&("fright"===f.mode?(f.setMode("dead"),d.stats.addGhostPoints(),d.audio.play("eat-ghost")):"dead"!==f.mode&&(d.audio.play("death"),d.stats.removeLife()?d.death(d.continueAfterDeath):d.death(d.end)))})},this.setMode=function(a){this.mode=a},this.reset=function(){var a=this;a.position=d.playerStart,a.movement={x:-1,y:0,objectRotation:180},a.newMovement=a.movement,a.mode="chase"}},b.namespace("pacman.Player",c)}(window.jQuery,window.getNamespace()),function(a,b){"use strict";var c,d=a.helpers.utils.log,e=a.pacman||{};c=function(a,c){var f=this;return f.name=a,f.originalStart=c,f.position=c,f.movement={x:-1,y:0},f.untilNextTile=e.config.tileSize/2,f.mode="chase",f.forcedTarget=e.goodTarget,f.elroyLevel=0,e.ai[f.name]?(f.ai=e.ai[f.name],f.colour=e.config.colours.ghost[f.name],f.body=e.paper.path(),f.leftEye=e.paper.circle(0,0,0),f.leftPupil=e.paper.circle(0,0,0),f.rightEye=e.paper.circle(0,0,0),f.rightPupil=e.paper.circle(0,0,0),f.animate=function(){this.body.attr(e.svg.ghostBody(this.position,this.colour)),this.leftEye.attr(e.svg.ghostEye("left",this.position)),this.leftPupil.attr(e.svg.ghostPupil("left",this.position,this.movement)),this.rightEye.attr(e.svg.ghostEye("right",this.position)),this.rightPupil.attr(e.svg.ghostPupil("right",this.position,this.movement))},f.move=function(){var a,c,d=e.tools.enemySpeed(this.mode,this.elroyLevel),f=e.tools.getTilePosition(this.position);"dead"!==this.mode&&e.slowMovement[f.row][f.col]&&(d/=2),d<=this.untilNextTile?(this.untilNextTile-=d,this.doMovement(d)):(this.doMovement(this.untilNextTile),e.goodTarget.col===f.col&&e.goodTarget.row===f.row?this.forcedTarget="dead"===this.mode?e.ghostHome:null:"dead"===this.mode&&e.ghostHome.col===f.col&&e.ghostHome.row===f.row&&(this.mode="",this.setMode("chase"),this.forcedTarget=e.goodTarget),a=this.ai.getMovement(this.movement,f,this.mode,this.forcedTarget),a!==b&&(this.movement=a),c=d-this.untilNextTile,this.doMovement(c),this.untilNextTile=e.config.tileSize-c),this.correctPosition()},this.doMovement=function(a){var b={x:this.position.x+a*this.movement.x,y:this.position.y+a*this.movement.y};this.position=b},this.correctPosition=function(){this.position.x<0&&(this.position.x+=e.config.tileSize*e.fieldInUse.width),this.position.x>e.config.tileSize*e.fieldInUse.width&&(this.position.x-=e.config.tileSize*e.fieldInUse.width),this.position.y<0&&(this.position.y+=e.config.tileSize*e.fieldInUse.height),this.position.y>e.config.tileSize*e.fieldInUse.height&&(this.position.y-=e.config.tileSize*e.fieldInUse.height)},this.setMode=function(a){switch(a){case"chase":case"scatter":case"fright":"dead"!==this.mode&&(this.mode=a);break;case"dead":this.mode=a,this.forcedTarget=e.goodTarget}return"dead"===this.mode?(this.body.hide(),void 0):"fright"===this.mode?(this.colour=e.config.colours.frightGhost,this.body.show(),void 0):(this.colour=e.config.colours.ghost[this.name],this.body.show(),void 0)},this.reset=function(){this.position=this.originalStart,this.movement={x:-1,y:0},this.untilNextTile=e.config.tileSize/2,this.setMode("chase"),this.forcedTarget=e.goodTarget},void 0):(d("Enemy with name "+f.name+" is not available!"),void 0)},a.namespace("pacman.Enemy",c)}(window.app||{}),function(a,b){"use strict";var c,d=a.pacman||{};c={setUpDirections:function(a,b,c){var d=[];return 1!==a.y&&c[b.row-1][b.col]&&d.push({distance:null,x:0,y:-1}),-1!==a.x&&c[b.row][b.col+1]&&d.push({distance:null,x:1,y:0}),-1!==a.y&&c[b.row+1][b.col]&&d.push({distance:null,x:0,y:1}),1!==a.x&&c[b.row][b.col-1]&&d.push({distance:null,x:-1,y:0}),d},setDistances:function(a,c,e){b.each(a,function(a,b){b.distance=d.tools.distanceBetween(c.col+b.x,c.row+b.y,e.col,e.row)})}},c.blinky=function(){function a(a,b,e,f){var g,h,i,j;if(null!==f)g=d.enemyMovement,h=c.setUpDirections(a,b,g),c.setDistances(h,b,f);else switch(g=d.playerMovement,h=c.setUpDirections(a,b,g),e){case"scatter":c.setDistances(h,b,{row:0,col:d.fieldInUse.width});break;case"chase":i=d.tools.getTilePosition(d.player.position),c.setDistances(h,b,i);break;case"fright":return j=Math.floor(Math.random()*h.length),h[j]}return h.sort(d.tools.sortByDistance),h[0]}return{getMovement:a}}(),c.pinky=function(){function a(a,b,e,f){var g,h,i,j,k,l;if(null!==f)g=d.enemyMovement,h=c.setUpDirections(a,b,g),c.setDistances(h,b,f);else switch(g=d.playerMovement,h=c.setUpDirections(a,b,g),e){case"scatter":c.setDistances(h,b,{row:0,col:0});break;case"chase":i=d.tools.getTilePosition(d.player.position),j=d.player.movement,k={col:i.col+4*j.x,row:i.row+4*j.y},c.setDistances(h,b,k);break;case"fright":return l=Math.floor(Math.random()*h.length),h[l]}return h.sort(d.tools.sortByDistance),h[0]}return{getMovement:a}}(),c.inky=function(){function a(a,b,e,f){var g,h,i,j,k,l,m,n,o;if(null!==f)g=d.enemyMovement,h=c.setUpDirections(a,b,g),c.setDistances(h,b,f);else switch(g=d.playerMovement,h=c.setUpDirections(a,b,g),e){case"scatter":c.setDistances(h,b,{row:d.fieldInUse.height,col:d.fieldInUse.width});break;case"chase":i=d.tools.getTilePosition(d.player.position),j=d.player.movement,k={row:i.row+2*j.y,col:i.col+2*j.x},l=d.tools.getTilePosition(d.ghosts[0].position),m={row:k.row-l.row,col:k.col-l.col},n={row:k.row+m.row,col:k.col+m.col},c.setDistances(h,b,n);break;case"fright":return o=Math.floor(Math.random()*h.length),h[o]}return h.sort(d.tools.sortByDistance),h[0]}return{getMovement:a}}(),c.clyde=function(){function a(a,b,e,f){var g,h,i,j;if(null!==f)g=d.enemyMovement,h=c.setUpDirections(a,b,g),c.setDistances(h,b,f);else switch(g=d.playerMovement,h=c.setUpDirections(a,b,g),e){case"scatter":c.setDistances(h,b,{row:d.fieldInUse.height,col:0});break;case"chase":i=d.tools.getTilePosition(d.player.position),d.tools.distanceBetween(i.col,i.row,b.col,b.row)>8?c.setDistances(h,b,i):c.setDistances(h,b,{row:d.fieldInUse.height,col:0});break;case"fright":return j=Math.floor(Math.random()*h.length),h[j]}return h.sort(d.tools.sortByDistance),h[0]}return{getMovement:a}}(),a.namespace("pacman.ai",c)}(window.app||{},window.jQuery),function(a){"use strict";var b={containerId:"game",tileSize:19,lives:2,colours:{pacman:"rgb(255, 255, 0)",frightGhost:"rgb(0, 0, 255)",frightAlarm:"rgb(255, 255, 255)",ghost:{blinky:"rgb(255, 0, 0)",inky:"rgb(0, 245, 255)",pinky:"rgb(255, 192, 203)",clyde:"rgb(255, 215, 0)"},background:"rgb(0, 0, 0)",wall:"rgb(0, 100, 200)",highlight:"rgb(255, 0, 200)",gate:"rgb(255, 0, 0)",pellet:"rgb(255, 255, 0)",powerPellet:"rgb(255, 255, 255)",textColour:"rgb(255, 255, 255)"},playField:{level1:{width:40,height:20,field:["WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW","WWWWWWUCCCCCCCCCCCCCCCUCCCCCCCCCCCCCCUWW","WWWWWWCWWWWWWWWWWWWWWWWWWWWWWWWWCWWWWCWW","WWWWWWCWWWWWWWWWWWWWWWWWWWWWWWWWCCCCCCWW","WWWWWWCWWWWWWwWwWwwwwwWwWWWWWWWwCwWWwCWW","WWWWWWCCCUCCCwwwCCCwUCCCwWwwwWwUCwWwCCWW","WWWWWWCWWWWWCwUwCWCwCWWCCwwwwwCCCwwWCCWW","WWWWWWCWWWWWCwCwCWCwCWWCCCwCwCCCCwWwWCWW","SSCCCCCCCCCCCCCCCCCCCCCPNCCCCCCCCCCCCCSS","WWWWWWCWWCWWWWWCWWWWWCWWWWWCWWCWWWWWWWWW","WWWWWWCWWCWWWWWCWWWWWCWWWWWCWWCWWWWWWWWW","WWWWWWCWWCWWWWWCWWWWWCWWWWWCWWCWWWWWWWWW","WWWWWWCWWCWWWWWCWWWWWCWWWWWCWWCWWWWWWWWW","WWWWWWUCCCCCCCCUCCCCCCCCCCCZCCZWWWWWWWWW","WWWWWWWWWWWWWWWWWWWCWCWWWWWGWWGWWWWWWWWW","WWWWWWWWWWWWWWWWWWWCWCWWWWWHHHHWWWWWWWWW","WWWWWWWWWWWWWWWWWWWCUCWWWWWHXHHWWWWWWWWW","WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW","WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW","WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW"]},level2:{width:40,height:20,field:["WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW","WWWWWWUCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCUWW","WWWWWWCWWWWWWWWWWWWWWWWWWWWWWWWWCWWWWCWW","WWWWWWCWWWWWWWWWWWWWWWWWWWWWWWWWCCCCCCWW","WWWWWWCWWWWWUwWwUwwwwwUwWWWWWWWwCwCWwCWW","WWWWWWCCCCCCCwwwCCCwCCCCwWwwwWwCCwCwCCWW","WWWWWWCWWWWWCwUwCWCwCWWCCwwwwwCCCwwUCCWW","WWWWWWCWWWWWCwCwCWCwCCCCCCwCwCCCCwCwWCWW","SSCCCCCCCCCCCCCCCCCCCCCPNCCCCCCCCCCCCCSS","WWWWWWCWWCWWWWWCWWWWWCWWWWWCWWCWWWWWWWWW","WWWWWWCCCCWWWWWCWWWWWCWWWWWCCCCWWWWWWWWW","WWWWWWCWWCWWWWWCWWWWWCWWWWWCWWCWWWWWWWWW","WWWWWWCWWCWWWWWCWWWWWCWWWWWCWWCWWWWWWWWW","WWWWWWUCCCCCCCUCCCCCCCCCCCCZCCZWWWWWWWWW","WWWWWWWWWWWWWWWWWWWCWCWWWWWGWWGWWWWWWWWW","WWWWWWWWWWWWWWWWWWWCWCWWWWWHHHHWWWWWWWWW","WWWWWWWWWWWWWWWWWWWCUCWWWWWHXHHWWWWWWWWW","WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW","WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW","WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW"]}},muted:!1,video:{opts:{},attrs:{}},audio:{opts:{}}};a.namespace("pacman.config",b)}(window.getNamespace()),function(a){"use strict";var b=function(){function b(){var a,b=o.playField[n.stats.getLevelString()],c=o.tileSize,d=b.width*c,e=b.height*c;n.paper.clear(),n.paper.setSize("100%","100%"),a=n.paper.rect(0,0,d,e),a.attr("fill",o.colours.background)}function c(a,b){var c=o.tileSize,d=n.paper.rect(b*c+c/6,a*c+c/6,c/1.5,c/1.5);d.attr("fill",o.colours.wall).attr("stroke","none")}function d(a,b){var c=o.tileSize,d=n.paper.rect(b*c+c/6,a*c+c/6,c/1.5,c/1.5);d.attr("fill",o.colours.highlight).attr("stroke","none")}function e(a,b){var c=o.tileSize,d=n.paper.rect(b*c+c/6,a*c+c/6,c/1.5,c/1.5);d.attr("fill",o.colours.gate).attr("stroke","none")}function f(a,b){var c=o.tileSize,d=n.paper.rect(b*c+c/(8/3),a*c+c/(8/3),c/4,c/4);d.attr("fill",o.colours.pellet).attr("stroke","none"),d.eaten=!1,n.pellets[a][b]=d}function g(a,b){var c=o.tileSize,d=n.paper.rect(b*c+c/(10/3),a*c+c/(10/3),c/2.5,c/2.5),e=Raphael.animation({"50%":{transform:"s1.5"},"100%":{transform:""}},1e3).repeat("Infinity");d.attr("fill",o.colours.powerPellet).attr("stroke","none").animate(e),d.isPowerPellet=!0,d.eaten=!1,n.pellets[a][b]=d}function h(a,b){var c=o.tileSize;n.playerStart={x:(b+1)*c,y:a*c+c/2}}function i(a,b){var c=o.tileSize;n.enemyStarts.push({x:(b+1)*c,y:a*c+c/2})}function j(){var a,b=0,c=n.fieldInUse.height,d=0,e=n.fieldInUse.width;for(b=0;c>b;b+=1)for(var d=0;e>d;d+=1)a=n.pellets[b][d],void 0!==a&&(a.show(),a.eaten=!1,n.pelletCount=n.pelletCount+1)}function k(){b();{var a=o.tileSize,c=o.colours,d=o.playField[n.stats.getLevelString()],e=d.width,f=d.height,g=e/2*a,h=f/3*a,i=n.paper.text(g,h,"Loading Pacman");n.stats.getTopScores()}i.attr({fill:c.textColour})}function l(){b()}function m(){var a=o.playField[n.stats.getLevelString()],j=a.height,k=a.width,l=0,m=0;for(n.fieldInUse=a,b(),n.playerMovement=[],n.enemyMovement=[],n.pellets=[],n.enemyStarts=[],n.slowMovement=[],n.pelletCount=0,l=0;j>l;l+=1)for(n.playerMovement[l]=[],n.enemyMovement[l]=[],n.pellets[l]=[],n.slowMovement[l]=[],m=0;k>m;m+=1)switch(n.playerMovement[l][m]=!0,n.enemyMovement[l][m]=!0,n.slowMovement[l][m]=!1,a.field[l].charAt(m)){case"W":c(l,m),n.playerMovement[l][m]=!1,n.enemyMovement[l][m]=!1;
break;case"w":d(l,m),n.playerMovement[l][m]=!1,n.enemyMovement[l][m]=!1;break;case"G":e(l,m),n.playerMovement[l][m]=!1;break;case"C":f(l,m),n.pelletCount++;break;case"U":g(l,m),n.pelletCount++;break;case"P":h(l,m);break;case"H":i(l,m);break;case"B":break;case"Z":n.goodTarget={row:l,col:m};break;case"X":n.ghostHome={row:l,col:m};break;case"S":n.slowMovement[l][m]=!0}}var n=a.pacman||{},o=n.config||{};return{buildScreenStart:k,buildScreenGame:m,buildScreenEnd:l,renewPellets:j}}();a.namespace("pacman.fieldBuilder",b)}(window.app||{}),function(a){"use strict";var b=function(){function b(){return j[38]||j[175]||j[87]}function c(){return j[40]||j[176]||j[83]}function d(){return j[37]||j[178]||j[65]}function e(){return j[39]||j[177]||j[68]}function f(){return j[32]}function g(b){var c=b.keyCode;j[c]=!0,f()&&a.pacman.pause()}function h(a){var b=a.keyCode;j[b]=!1}function i(){var a={x:0,y:0,objectRotation:null};return b()?(a.y=-1,a.objectRotation=270):c()?(a.y=1,a.objectRotation=90):d()?(a.x=-1,a.objectRotation=180):e()&&(a.x=1,a.objectRotation=0),null===a.objectRotation?null:a}var j=[],k=0;for(k=0;256>k;k+=1)j[k]=!1;return{keydown:g,keyup:h,getMovement:i}}();a.namespace("pacman.keyhandler",b)}(window.getNamespace()),function(a){"use strict";var b,c,d=app.pacman||{};b=function(){function a(a,b){var e=c.tileSize/2,f=30*Math.sin(d.frame/30*Math.PI),g=359-f,h=g-f>180;return f=f%360*Math.PI/180,g=g%360*Math.PI/180,{path:[["M",a.x,a.y],["l",e*Math.cos(f),e*Math.sin(f)],["A",e,e,0,+h,1,a.x+e*Math.cos(g),a.y+e*Math.sin(g)],["z"]],transform:["r",b,a.x,a.y],fill:c.colours.pacman,stroke:"none"}}function b(a,b){var d=c.tileSize,e=d/2;return{path:[["M",a.x-e,a.y+e],["c",0,-2.7*e,2*e,-2.7*e,2*e,0],["z"]],stroke:"none",fill:b}}function e(a,b){var d=c.tileSize,e=b.x-d/6;return"right"===a&&(e+=d/3),{cx:e,cy:b.y-d/5,r:d/5,fill:"rgb(255, 255, 255)",stroke:"none"}}function f(a,b,d){var e=c.tileSize,f=b.x-e/6;return"right"===a&&(f+=e/3),{cx:f+2*d.x,cy:b.y-e/5+d.y*(e/10),r:e/10,fill:"rgb(0, 0, 0)",stroke:"none"}}function g(a,b){var e=d.paper.text(a.x,a.y,b);e.attr({font:c.tileSize+'px "Arial"',fill:"rgb(255,0,0)"}),e.animate({transform:"s3"},1e3,">",e.remove)}function h(){$.each(d.ghosts,function(a,b){"fright"===b.mode&&(b.colour=b.colour===c.colours.frightAlarm?c.colours.frightGhost:c.colours.frightAlarm)})}function i(a){d.player.paperObject.animate({transform:"s0.01"},1e3,"linear",a)}return c=d.config,{pacmanBody:a,ghostBody:b,ghostEye:e,ghostPupil:f,animateCountdownNumber:g,blinkGhosts:h,animatePlayerDeath:i}}(),a.namespace("pacman.svg",b)}(window.getNamespace()),function(a){"use strict";var b=function(){function b(){}function c(){}function d(){x+=1}function e(a){w=a}function f(a){var b,c=t%1e4;t+=a,b=t%1e4,c>b&&i(),l()}function g(){f(y),y*=2,l()}function h(){y=200}function i(){v+=1,l()}function j(){return v--,l(),0>v?!1:!0}function k(){u++,s.updateElroy()}function l(){$(".score-points .score-value").html("Points: "+t),$(".score-lives .score-value").html("Lives: "+(0>v?0:v)),$(".score-level .score-value").html("Level: "+u)}function m(){t=0,u=1,v=s.config.lives,l()}function n(){return A}function o(){A&&A.length||(A=[]),B={name:w,points:t,date:(new Date).getTime(),time:x},A.push(B),r&&r.setItem("pacman",C.jsonToString(A)),z.push(t)}function p(){return z.sort(function(a,b){return b-a}),z}function q(){return s.config.playField["level"+u]?"level"+u:"level1"}var r,s=a.pacman,t=0,u=1,v=s.config.lives,w="Player",x=0,y=200,z=[],A=[],B={},C=a.helpers.utils;return window.localStorage&&window.localStorage.getItem&&(r=window.localStorage,A=C.jsonToObject(r.getItem("pacman"))),{setTimeStart:b,setTimeEnd:c,setPlayerName:e,updateTime:d,getStore:n,getLevelString:q,frightStart:h,addPoints:f,addGhostPoints:g,removeLife:j,addLevel:k,level:u,updateView:l,resetStats:m,sendPoints:o,getTopScores:p}}();a.namespace("pacman.stats",b)}(window.getNamespace()),function(a,b){"use strict";function c(b,c,d){var e=this;e.paper=b,e.opts=a.extend(!0,{},g,f.video.opts,c),e.attrs=a.extend(!0,{},h,f.video.attrs,d),e.init()}var d=b.helpers.utils.log,e=b.pacman||{},f=e.config||{},g={x:0,y:0,width:"200px",height:"100px"},h={fill:"#000"};c.prototype={playVideo:function(b){var c,e=this,f=[];e.name=b?b:"death",e.video=null,f.push("<video>"),f.push('<source src="assets/video/'+e.name+'.mp4" type=\'video/mp4; codecs="avc1.42E01E, mp4a.40.2"\'>'),f.push('<source src="assets/video/'+e.name+'.ogv" type=\'video/ogg; codecs="theora, vorbis"\'>'),f.push('<source src="assets/video/'+e.name+'.webm" type="video/webm">'),f.push("</video>"),c=a(f.join("")),e.video=c[0],e.$wrapper.empty().html(c),c.on({"click.video pause.video ended.video":function(){d("video ended"),e.hide()},"loadstart.video":function(){switch(e.video.networkState){case e.video.NETWORK_EMPTY:d("video network - empty source");break;case e.video.NETWORK_IDLE:d("video network - video choosen and no download progress");break;case e.video.NETWORK_LOADING:d("video network - browser trying to load video");break;case e.video.NETWORK_NO_SOURCE:d("video network - no video source has been successfully loaded yet")}},"playing.video":function(){d("video playing")},"timeupdate.video":function(){d("video timeupdate")},"progress.video":function(){d("video loading progress"),e.loaded=0;try{void 0!==e.video.buffered&&void 0!==e.video.duration&&(e.loaded=parseInt(e.video.buffered.end(0)/e.video.duration*100,10),a.publish("video.progress",[e.loaded]))}catch(b){d("video loading progess - tryCatch catch: "+b)}finally{d("video loading progess - tryCatch finally")}},"canplay.video":a.proxy(function(){d("video is ready to play"),e.video.currentTime=0,void 0!==e.muted&&(e.video.muted=e.muted),e.video.statusPlaying||(e.video.play(),e.video.statusPlaying=!0)},this),"error.video":function(){d("video error")}})},stopVideo:function(){var a=this,b=a.video;b&&(b.pause(),a.video.statusPlaying=!1)},show:function(b){var c=this;c.container.animate({opacity:1},300,">"),c.$wrapper.fadeIn(300),c.playVideo(b),a.publish("pacman.videoshow")},mute:function(a){var b=this,c=b.video;a||(a=!0),c&&(c.muted=a),b.muted=a},hide:function(){var b=this;b.container.animate({opacity:0},300,">"),b.$wrapper.fadeOut(300),b.stopVideo(),a.publish("pacman.videohide")},bindEvents:function(){var a=this;a.group.mouseup(function(){alert("asd")})},init:function(){var b,c,d=this,e=d.opts;d.x=e.x||0,d.y=e.y||0,d.width=e.width||d.paper.width,d.height=e.height||d.paper.height,d.container=d.paper.rect(d.x,d.y,d.width,d.height).attr(d.attrs),c=d.container.node.parentNode.parentNode,b=c.id||c.parentNode.id,d.$container=a("#"+b),d.$wrapper=a('<div class="video-wrapper"></div>').insertAfter(d.$container),d.group=d.paper.set(),d.group.push(d.container),d.group.push(d.$wrapper),d.container.attr({opacity:0}),d.$wrapper.hide(),d.bindEvents(),d.hide()}},b.namespace("pacman.Video",c)}(window.jQuery,window.getNamespace()),function(a,b,c){"use strict";function d(a,c){var d=this;d.$el=a,d.opts=b.extend(!0,{},h,g.audio.opts,c),d.muted=c.muted,d.init()}var e=c.helpers.utils.log,f=c.pacman||{},g=f.config||{},h={};e=function(){},d.prototype={renderSource:function(b,c){var d=a.createElement("source");switch(c){case"audio/ogg":d.src=b+".ogg";break;case"audio/mpeg":d.src=b+".mp3";break;case"audio/x-wav":d.src=b+".wav"}return d.type=c,d.media="all",d},loadAudio:function(c,d){var f,g=this;g.tracks[c]||(g.tracks[c]=f={},f.audio=a.createElement("audio"),f.$audio=b(f.audio),f.$audio.appendTo(g.$el),d||(d="assets/audio/"+c),f.$audio.prepend(g.renderSource(d,"audio/x-wav")),f.$audio.prepend(g.renderSource(d,"audio/mpeg")),f.$audio.prepend(g.renderSource(d,"audio/ogg")),f.$audio.on({"loadstart.audio":function(){switch(e("audio loadstart"),f.loaded=0,f.audio.networkState){case f.audio.NETWORK_EMPTY:e("audio network - empty source");break;case f.audio.NETWORK_IDLE:e("audio network - audio choosen and no download");break;case f.audio.NETWORK_LOADING:e("audio network - browser trying to load audio");break;case f.audio.NETWORK_NO_SOURCE:e("audio network - no source has been successfully loaded yet")}},"loadedmetadata.audio":function(){e("audio loadedmetadata")},"loadeddata.audio":function(){e("audio loadeddata")},"progress.audio":function(){e("audio progress"),f.loaded=0;try{void 0!==f.audio.buffered&&void 0!==f.audio.duration&&(f.loaded=parseInt(f.audio.buffered.end(0)/f.audio.duration*100,10),b.publish("audio.progress",[f.loaded]))}catch(a){e("audio progess - tryCatch catch: "+a)}finally{e("audio progess - tryCatch finally")}},"canplay.audio":function(){e("audio can play"),f.audio.play()},"timeupdate.audio":function(){e("audio timeupdate"),f.audio.muted=g.muted},"play.audio":function(){e("audio playing"),f.audio.muted=g.muted},"pause.audio":function(){e("audio pause ended")},"pause.audio ended.audio":function(){e("audio pause ended")},"ended.audio":function(){e("audio ended")},"waiting.audio ":function(){e("audio waiting for data")},"suspend.audio ":function(){e("audio suspend")},"stalled.audio ":function(){e("audio stalled")},"error.audio":function(){e("audio error")},"abort.audio":function(){e("audio abort")}}))},play:function(a){var b,c=this;c.tracks[a]?(b=c.tracks[a],b.audio.play()):c.loadAudio(a)},stop:function(a){var c=this;a&&c.tracks[a]?c.tracks[a].audio.stop():c.tracks.length&&b.each(function(a,b){b.audio.pause()})},mute:function(a,c){var d,e=this;c||(c=!0),a&&e.tracks[a]?(d=e.tracks[a],d.audio.muted=c):e.tracks.length&&b.each(function(a,b){b.audio.muted=c}),e.muted=c},init:function(){var a=this;a.$el&&a.$el.length||(a.$el=b('<div class="audio-wrapper"></div>').appendTo(b("body"))),a.tracks={}}},c.namespace("pacman.Audio",d)}(document,window.jQuery,window.getNamespace()),function(a){"use strict";var b=new a.Marionette.Application;b.addRegions({regionHeader:"#region-header",regionMain:"#region-main",regionFooter:"#region-footer"}),b.on("initialize:before",function(){}),b.on("initialize:after",function(){a.history&&a.history.start({trigger:!0})}),b.on("start",function(){}),b.addInitializer(function(){var a=new b.Controller;a.router=new b.Router({controller:a}),a.initialize(),b.controller=a}),app.namespace("marionette",b)}(window.Backbone,window.getNamespace()),function(a,b){"use strict";var c=a.Model.extend({defaults:{id:0,name:"",visible:!0}}),d=a.Model.extend({defaults:{id:0,fullscreen:!1,sound:!0,playfield:0}}),e=a.Model.extend({defaults:{id:0,name:"",points:""}});b.namespace("marionette.models.Headline",c),b.namespace("marionette.models.Config",d),b.namespace("marionette.models.Highscore",e)}(window.Backbone,window.getNamespace()),function(a,b){"use strict";var c=a.Collection.extend({model:b.marionette.models.Highscore,comparator:function(a){return-a.get("points")},initialize:function(){this.add(this.model)}});b.namespace("marionette.collections.Highscore",c)}(window.Backbone,window.getNamespace()),function(a,b,c){"use strict";var d=(app.marionette,Marionette.ItemView.extend({tagName:"li",template:"#template-layout-highscore-item"})),e=Marionette.CollectionView.extend({tagName:"ul",itemView:d});c.namespace("marionette.views.HighscoreItem",d),c.namespace("marionette.views.Highscore",e)}(window.jQuery,window.Backbone,window.getNamespace()),function(a,b,c){"use strict";var d,e={},f=b("#content"),g=c.pacman;e.Header=a.Marionette.ItemView.extend({template:"#template-layout-header",tagName:"h1",templateHelpers:{showHeadline:function(){return this.name}},initialize:function(){var a=this;a.$el=b(a.el)},onShow:function(){},onRender:function(){this.$el.find(".tooltip").tooltip()}}),e.Intro=a.Marionette.Layout.extend({template:"#template-layout-intro",tagName:"nav",templateHelpers:{},events:{"click .button-game-pacman":"onClickButtonGamePacman"},onClickButtonGamePacman:function(a){a.preventDefault(),b("#region-footer .button-game-pacman").trigger("click")},initialize:function(){var a=this;a.$el=b(a.el),a.$el.addClass("row center")},onShow:function(){},onRender:function(){this.$el.find(".tooltip").tooltip(),f.removeClass("loading")},onBeforeClose:function(){f.addClass("loading")}}),e.Pacman=a.Marionette.Layout.extend({template:"#template-layout-pacman",regions:{game:"#game",intro:"#score"},templateHelpers:{},initialize:function(){var a=this;a.$el=b(a.el)},onShow:function(){var a=c.pacman,d=a.config,e=!1,f=b("#region-main").width()/d.playField[a.stats.getLevelString()].width,g=0,h=function(){f=b("#region-main").width()/d.playField[a.stats.getLevelString()].width,d.tileSize=f,a.initialize(),e?(b("#fullscreen").show(),b("#fullscreen button").on({click:function(){a.pause(!0),b("#reveal-game-exit-fullscreen").reveal()}})):b("#fullscreen").hide(),b.subscribe("pacman.end",function(){c.marionette.controller.highscore(),b("#region-footer .button").removeClass("disabled"),b("#region-footer .button[href=#highscore]").addClass("disabled")})};app.marionette.controller.modelConfig.get("fullscreen")&&(g=1500,app.plugins.fullscreen(),e=!0),window.setTimeout(h,g)},onRender:function(){f.addClass("pacman").removeClass("loading")},onBeforeClose:function(){f.removeClass("pacman").addClass("loading"),c.pacman.destroy()}}),e.Highscore=a.Marionette.Layout.extend({template:"#template-layout-highscore",regions:{list:"#list-highscore"},tagName:"div",templateHelpers:{},events:{"click .button-game-pacman":"onClickButtonGamePacman"},onClickButtonGamePacman:function(a){a.preventDefault(),b("#region-footer .button-game-pacman").trigger("click")},initialize:function(){var a=this;a.$el=b(a.el)},onShow:function(){var a,b,d,e=this,f=c.marionette,h=(f.store,g.stats.getStore()),i=1;h?(a=new f.collections.Highscore(h),b=a.map(function(a){return{counter:i++,name:a.get("name"),points:a.get("points")}})):b=[{name:"There are no results saved yet",points:0}],d=new f.views.Highscore({collection:new f.collections.Highscore(b)}),e.list.show(d)},onRender:function(){this.$el.find(".tooltip").tooltip(),f.removeClass("loading")},onBeforeClose:function(){f.addClass("loading")}}),e.Footer=a.Marionette.Layout.extend({template:"#template-layout-footer",tagName:"nav",events:{"click .button-game-intro":"onClickButtonGameIntro","click .button-game-pacman":"onClickButtonGamePacman","click .button-game-highscore":"onClickButtonGameHighscore"},switchActiveButton:function(a){b("#region-footer .button").removeClass("disabled"),b("#region-footer .button[href=#"+a+"]").addClass("disabled")},switchRegionMain:function(a){b("#content").hasClass("pacman")?(g.pause(!0),b("#reveal-game-exit").reveal(),d=a):a()},onClickButtonGameIntro:function(a){a.preventDefault();var b=this;b.switchRegionMain(function(){c.marionette.controller.intro(),b.switchActiveButton("intro")})},onClickButtonGamePacman:function(a){if(a.preventDefault(),b("#content").hasClass("pacman"))g.pause();else{var d,e,f=function(){d=b("#form-enter-name-value").val(),e="checked"===b("#form-enter-name-fullscreen").attr("checked"),d&&""!==d||(d=b("#form-enter-name-value").attr("placeholder")),g.stats.setPlayerName(d),c.marionette.models.config.set({fullscreen:e})};b("#reveal-game-enter-name").on({"reveal:close":function(){b("#reveal-game-enter-name").off("reveal:close"),f()}}),b("#form-enter-name").on({submit:function(a){a.preventDefault(),b("#form-enter-name").off("submit"),f()}}),b("#reveal-game-enter-name").reveal()}},onClickButtonGameHighscore:function(a){a.preventDefault();var b=this;b.switchRegionMain(function(){c.marionette.controller.highscore(),b.switchActiveButton("highscore")})},onClickRevealGameEnterButtonYes:function(a){a.preventDefault(),this.$reveal.trigger("reveal:close"),c.marionette.controller.pacman(),this.switchActiveButton("pacman")},onClickRevealGameEnterButtonNo:function(a){a.preventDefault(),this.$reveal.trigger("reveal:close")},onClickRevealGameExitButtonYes:function(){var a=this;a.$reveal.trigger("reveal:close"),d&&d()},onClickRevealGameExitButtonNo:function(){this.$reveal.trigger("reveal:close"),g.pause(!1)},initialize:function(){var a=this;a.$el=b(a.el)},onShow:function(){window.location.hash&&window.location.hash.length>1&&this.switchActiveButton(window.location.hash.substr(1))},onRender:function(){{var a=this;a.$el}a.$el.addClass("row center"),a.$reveal=b(".reveal-modal"),a.$revealGameEnterName=b("#reveal-game-enter-name"),a.$revealGameExit=b("#reveal-game-exit"),a.$revealGameEnterName.data("events")||(a.$revealGameEnterName.data("events",!0),a.$revealGameEnterName.find(".button-reveal-game-enter-name-yes").on({click:b.proxy(a.onClickRevealGameEnterButtonYes,a)}),a.$revealGameEnterName.find(".button-reveal-game-enter-name-no").on({click:b.proxy(a.onClickRevealGameEnterButtonNo,a)})),a.$revealGameExit.data("events")||(a.$revealGameExit.data("events",!0),a.$revealGameExit.find(".button-reveal-game-exit-yes").on({click:b.proxy(a.onClickRevealGameExitButtonYes,a)}),a.$revealGameExit.find(".button-reveal-game-exit-no").on({click:b.proxy(a.onClickRevealGameExitButtonNo,a)})),a.$el.find(".tooltip").tooltip()},onBeforeClose:function(){var a=this,b=a.$el;b.find(".button-game-intro").off("click"),b.find(".button-game-pacman").off("click"),b.find(".button-game-highscore").off("click")}}),c.namespace("marionette.Layout",e)}(window.Backbone,window.jQuery,window.getNamespace()),function(a,b,c){"use strict";function d(b){!b&&a.event&&(b=a.event);var c="["+j+" Adapter] Event - key: "+(b.key||"no e.key event")+", url: "+(b.url||"no e.url event");i(c)}function e(a){var b="localStorage";switch(a){case"local":b="localStorage";break;case"session":b="sessionStorage"}return b}function f(a){var b=this;b.adapter=null,b.lifetime="local",b.init(a)}var g,h=c.helpers.utils,i=h.log,j="marionette store";f.prototype=f.fn={isSupported:function(){var b=this,c=e(b.lifetime);if(null===g)try{g=!!a[c]&&!!a[c].getItem}catch(d){i("["+j+" Adapter] "+j+" is not supported"),g=!1}return g},create:function(a,b,c){c=h.callback(c),b=h.jsonToString(b);try{return this.adapter.setItem(a,b),c(!0),!0}catch(e){return console.log(e),d(e),c(!1,e),e}},read:function(a,b){var c,e=this;b=h.callback(b);try{return(c=e.adapter.getItem(a))?(c=h.jsonToObject(c),b(c),c):(b(!1),!1)}catch(f){return d(f),b(!1,f),f}},update:function(a,b,c){return this.create(a,b,c)},remove:function(a,b){b=h.callback(b);try{return this.adapter.removeItem(a),b(a),a}catch(c){return d(c),b(!1,c),c}},open:function(b){var c=this,f=c.adapter,g=e(c.lifetime);if(b=h.callback(b),null===f)try{f=c.adapter=a[g],h.on(a,"storage",d),i("["+j+" Adapter] Try to create test resource"),c.create("test-item",{test:"test-content"},function(a){a?c.remove("test-item",function(){i("["+j+" Adapter] Test resource created and successfully deleted"),b(f)}):b(!1)})}catch(k){b(!1)}else c.isSupported()&&b(f)},init:function(a){var b=this;return b.isSupported()?(a&&a.lifetime&&(b.lifetime=a.lifetime),b):!1}},f.init=function(a,b){var c=new f;return c.init(a,b),c},c.namespace("marionette.Store",f)}(window,window.document,window.getNamespace()),function(a,b){"use strict";var c=a.Marionette.AppRouter.extend({appRoutes:{intro:"intro",pacman:"pacman",highscore:"highscore","":"intro"},initialize:function(){}});b.namespace("marionette.Router",c)}(window.Backbone,window.getNamespace()),function(a,b){"use strict";var c=a.Marionette.Controller.extend({intro:function(){var b=app.marionette,c=new b.Layout.Header({model:b.models.headline}),d=new b.Layout.Intro({});this.modelHeadline.set({name:"Pacman"}),b.regionHeader.show(c),b.regionMain.show(d),a.history.navigate("intro")},pacman:function(){var b=app.marionette,c=new b.Layout.Pacman({});b.regionHeader.close(),b.regionMain.show(c),a.history.navigate("pacman")},highscore:function(){var b=app.marionette,c=new b.Layout.Header({model:b.models.headline}),d=new b.Layout.Highscore({});this.modelHeadline.set({name:"Highscore"}),b.regionHeader.show(c),b.regionMain.show(d),a.history.navigate("highscore")},initialize:function(){var a,b=this,c=app.marionette,d=app.marionette.models,e=app.pacman,f=new c.Layout.Footer({}),g=new d.Headline({}),h=new d.Config({});h.on("change",function(){h.hasChanged("sound")&&(a=h.get("sound"),e.audio&&e.audio.mute(!a),e.video&&e.video.mute(!a))}),b.modelHeadline=d.headline=g,b.modelConfig=d.config=h,c.regionFooter.show(f),$("input[type=checkbox]").styledCheckbox()}});b.namespace("marionette.Controller",c)}(window.Backbone,window.getNamespace()),function(a,b,c,d){"use strict";var e,f=(c(a),c("html")),g=d.helpers,h=g.client,i=g.utils.on,j=h.hideStatusbar;c(b).ready(function(){return f.removeClass("no-js").addClass("js"),h.isMobile()?(f.addClass("mobile"),j(),i(b,"DOMContentLoaded",j),i(a,"orientationchange",j)):f.addClass("desktop"),b.body&&new FastClick(b.body),(e=h.isChrome()||h.isSafari())?(d.marionette.start(),void 0):(c("#layer-no-supported").show(),void 0)})}(window,document,window.jQuery,window.app||{});